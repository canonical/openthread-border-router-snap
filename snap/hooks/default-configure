#!/bin/bash -e

TAG="snap.$SNAP_NAME.hook.default-configure"

logger --tag=$TAG "CONFIG DUMP"
logger --tag=$TAG "infra-if=$(snapctl get infra-if)"
logger --tag=$TAG "thread-if=$(snapctl get thread-if)"
logger --tag=$TAG "radio-url=$(snapctl get radio-url)"
logger --tag=$TAG "autostart=$(snapctl get autostart)"
logger --tag=$TAG "source=$(snapctl get source)"

# logger --tag=$TAG "Setting defaults"

###############################################################################
# if [ -z "$(snapctl get infra-if)" ]; then
#     snapctl set infra-if=wlan0
# fi
# if [ -z "$(snapctl get thread-if)" ]; then
#     snapctl set thread-if=wpan0
# fi
# if [ -z "$(snapctl get radio-url)" ]; then
#     snapctl set radio-url="spinel+hdlc+uart:///dev/ttyACM0"
# fi
# if [ "$(snapctl get autostart)" == "" ]; then
#     snapctl set autostart=false
# fi

###############################################################################
# [ -z "$(snapctl get infra-if)" ]  && snapctl set infra-if=wlan0
# [ -z "$(snapctl get thread-if)" ] && snapctl set thread-if=wpan0
# [ -z "$(snapctl get radio-url)" ] && snapctl set radio-url="spinel+hdlc+uart:///dev/ttyACM0"
# [ -z "$(snapctl get autostart)" ] && snapctl set autostart=false
# [ -z "$(snapctl get source)" ]    && snapctl set autostart=default-config

###############################################################################
# set_default () {
#     opt="$(snapctl get $1)"
#     if [ -z "$opt" ]; then
#         logger --tag=$TAG "Config option '$1' is unset, defaulting to '$2'"
#         snapctl set "$1"="$2"
#     else
#         logger --tag=$TAG "Config option '$1' is preset to '$opt'"
#     fi
# }

# logger --tag=$TAG "Setting default config options"
# set_default infra-if  wlan0
# set_default thread-if wpan0
# set_default radio-url "spinel+hdlc+uart:///dev/ttyACM0"
# set_default autostart false
###############################################################################

# # This snap's services are disabled by default.
# # This is to allow enabling and starting the services with configurations
# # seeded from a Gadget snap
# if [ "$(snapctl get autostart)" = "true" ]; then
#     logger --tag=$TAG "'autostart' is enabled: starting and enabling openthread-border-router services."
#     snapctl start --enable openthread-border-router
# elif [ -n "$autostart_value" ] && [ "$autostart_value" != "false" ]; then
#     logger --tag=$TAG --stderr "Invalid value for 'autostart': $autostart_value"
#     exit 1
# fi
